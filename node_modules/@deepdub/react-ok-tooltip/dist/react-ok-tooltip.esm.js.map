{"version":3,"file":"react-ok-tooltip.esm.js","sources":["../src/Component/use-singleton.ts","../src/tooltip-methods.ts","../src/Component/Tooltip.utils.ts","../src/Component/Tooltip.tsx","../src/tooltip-groups.ts","../src/tooltip-helpers.ts","../src/tooltip.ts"],"sourcesContent":["import { useEffect } from 'react';\n\nconst singletons: { [name: string]: boolean } = {};\n\nexport function useSingleton(name: string) {\n  useEffect(() => {\n    if (singletons[name]) {\n      throw new Error(\n        `Singletons can only be rendered once (rendering \"${name}\").`\n      );\n    }\n\n    singletons[name] = true;\n\n    return () => {\n      singletons[name] = false;\n    };\n  }, [name]);\n}\n","import { deferredHideTooltip, deferredShowTooltip } from './tooltip-helpers';\n\nexport const DEFAULT_DELAY = 1000;\n\nexport interface TooltipProps {\n  title: string;\n  subtitle?: string;\n  maxWidth?: string;\n}\n\ninterface GlobalTooltipProps {\n  delay: number;\n}\n\ninterface TooltipMethods {\n  setPopperTooltipTriggerRef?: (element: HTMLElement | null) => void;\n  setAppTooltipProps?: (props: TooltipProps | undefined) => void;\n  setAppTooltipVisible?: (visible: boolean) => void;\n  popperTooltipUpdate?: Function | null;\n}\n\nexport const tooltipMethods: TooltipMethods = {};\n\nexport const globalTooltipProps: GlobalTooltipProps = {\n  delay: DEFAULT_DELAY,\n};\n\nexport function resetTooltipMethods() {\n  (Object.keys(tooltipMethods) as (keyof TooltipMethods)[]).forEach((key) => {\n    delete tooltipMethods[key];\n  });\n}\n\nexport function initTooltipMethods(methods: TooltipMethods) {\n  Object.assign(tooltipMethods, methods);\n}\n\nexport function setGlobalTooltipProps(props: GlobalTooltipProps) {\n  Object.assign(globalTooltipProps, props);\n}\n","export function createCssVarsForStyleProp(cssVars: {\n  [name: string]: string | number;\n}) {\n  return cssVars as any;\n}\n\nexport function cx(...args: (string | null | undefined)[]) {\n  return args.filter(Boolean).join(' ');\n}\n","import React, { useEffect, useRef, useState } from 'react';\nimport ReactDOM from 'react-dom';\nimport {\n  useArrowContainer,\n  usePopover,\n  PopoverState,\n} from 'react-tiny-popover';\nimport { useSingleton } from './use-singleton';\nimport {\n  DEFAULT_DELAY,\n  initTooltipMethods,\n  resetTooltipMethods,\n  setGlobalTooltipProps,\n} from '../tooltip-methods';\nimport { createCssVarsForStyleProp, cx } from './Tooltip.utils';\nimport styles from './Tooltip.module.scss';\n\nexport default function Tooltip({\n  backgroundColor = 'var(--color-black)',\n  borderColor = '#3a3a3a',\n  arrowSize = 5,\n  delay = DEFAULT_DELAY,\n  className,\n  arrowClassName,\n}: {\n  backgroundColor?: string;\n  borderColor?: string;\n  arrowSize?: number;\n  delay?: number;\n  className?: string;\n  arrowClassName?: string;\n} = {}) {\n  useSingleton('tooltip');\n\n  const [tooltipVisible, setTooltipVisible] = useState(false);\n  const [popoverState, setPopoverState] = useState<PopoverState>({\n    childRect: {} as any,\n    popoverRect: {} as any,\n    parentRect: {} as any,\n    boundaryRect: {} as any,\n    padding: 10,\n    nudgedLeft: 0,\n    nudgedTop: 0,\n    boundaryInset: 10,\n  });\n\n  const childRef = useRef<HTMLElement>();\n\n  const { positionPopover, popoverRef } = usePopover({\n    childRef,\n    positions: ['bottom'],\n    align: 'center',\n    padding: 10,\n    reposition: true,\n    boundaryInset: 0,\n    parentElement: document.body,\n    boundaryElement: document.body,\n    onPositionPopover: setPopoverState,\n  });\n\n  const { arrowContainerStyle, arrowStyle } = useArrowContainer({\n    ...popoverState,\n    arrowColor: backgroundColor,\n    arrowSize: arrowSize,\n  });\n\n  useEffect(() => {\n    initTooltipMethods({\n      setPopperTooltipTriggerRef: (ref) => {\n        childRef.current = ref ?? undefined;\n      },\n      setAppTooltipProps: (props) => {\n        if (\n          !props ||\n          !contentRef.current ||\n          !titleRef.current ||\n          !subtitleRef.current\n        ) {\n          return;\n        }\n\n        contentRef.current.style.maxWidth = props.maxWidth ?? 'none';\n        titleRef.current.innerText = props.title;\n        subtitleRef.current.style.display = props.subtitle ? 'block' : 'none';\n        subtitleRef.current.innerText = props.subtitle ?? '';\n      },\n      setAppTooltipVisible: setTooltipVisible,\n      popperTooltipUpdate: positionPopover,\n    });\n\n    return () => {\n      resetTooltipMethods();\n    };\n  }, [positionPopover]);\n\n  useEffect(() => {\n    setGlobalTooltipProps({\n      delay: delay,\n    });\n  }, [delay]);\n\n  const contentRef = useRef<HTMLDivElement>(null);\n  const titleRef = useRef<HTMLDivElement>(null);\n  const subtitleRef = useRef<HTMLDivElement>(null);\n\n  return ReactDOM.createPortal(\n    <div\n      ref={popoverRef}\n      className={cx(styles.tooltipContainer, className)}\n      style={{\n        visibility: tooltipVisible ? 'visible' : 'hidden',\n        ...arrowContainerStyle,\n        ...createCssVarsForStyleProp({\n          '--arrow-size': `${arrowSize}px`,\n          '--background-color': backgroundColor,\n          '--border-color': borderColor,\n        }),\n      }}\n    >\n      <div className={cx(styles.arrow, arrowClassName)} style={arrowStyle} />\n      <div className={styles.content} ref={contentRef}>\n        <div className={styles.title} ref={titleRef}></div>\n        <div className={styles.subtitle} ref={subtitleRef}></div>\n      </div>\n    </div>,\n    document.body\n  );\n}\n","export const tooltipGroups: { [groupId: string]: HTMLElement } = {};\n\nexport function tooltipGroup(groupId?: string) {\n  return (element: HTMLElement | null) => {\n    groupId ??= `tooltipGroup_${Math.round(Math.random() * 100000).toString()}`;\n\n    function handleMouseOver(e: MouseEvent) {\n      tooltipGroups[groupId!] = e.currentTarget as HTMLElement;\n    }\n\n    if (!element) {\n      return;\n    }\n\n    element.addEventListener('mouseover', handleMouseOver, { capture: true });\n    element.dataset.okTooltipGroupId = groupId;\n  };\n}\n","type TooltipState =\n  | 'await-show'\n  | 'visible'\n  | 'await-hide'\n  | 'hidden-grace'\n  | 'hidden';\n\nlet state: TooltipState = 'hidden';\nlet timeout: number;\n\nfunction wait(callback: Function, delay: number) {\n  timeout = window.setTimeout(callback, delay);\n}\n\nfunction unwait() {\n  clearTimeout(timeout);\n}\n\nexport function deferredShowTooltip(delay: number, showTooltip: Function) {\n  if (state === 'await-show') {\n    return;\n  }\n\n  if (state === 'visible') {\n    return;\n  }\n\n  if (state === 'await-hide' || state === 'hidden-grace') {\n    unwait();\n    state = 'visible';\n    showTooltip();\n  }\n\n  if (state === 'hidden') {\n    state = 'await-show';\n\n    wait(() => {\n      state = 'visible';\n      showTooltip();\n    }, delay);\n  }\n}\n\nexport function deferredHideTooltip(hideTooltip: Function) {\n  if (state === 'await-show') {\n    unwait();\n    state = 'hidden';\n  }\n\n  if (state === 'visible') {\n    state = 'await-hide';\n    wait(() => {\n      hideTooltip();\n      state = 'hidden-grace';\n      wait(() => {\n        state = 'hidden';\n      }, 500);\n    }, 50);\n  }\n\n  if (state === 'await-hide') {\n    return;\n  }\n\n  if (state === 'hidden-grace') {\n    return;\n  }\n\n  if (state === 'hidden') {\n    return;\n  }\n}\n","import { tooltipGroups } from './tooltip-groups';\nimport { deferredHideTooltip, deferredShowTooltip } from './tooltip-helpers';\nimport { globalTooltipProps, tooltipMethods } from './tooltip-methods';\n\nexport const DEFAULT_DELAY = 1000;\n\nexport interface TooltipProps {\n  title: string;\n  subtitle?: string;\n  maxWidth?: string;\n}\n\nexport function tooltip(\n  title: string,\n  {\n    groupId,\n    ...appTooltipProps\n  }: { groupId?: string | null } & Omit<TooltipProps, 'title'> = {}\n) {\n  return (element: HTMLElement | null) => {\n    function onMouseEnter(e: MouseEvent) {\n      const wrappingGroupId = element!.closest<HTMLElement>(\n        '[data-ok-tooltip-group-id]'\n      )?.dataset.okTooltipGroupId;\n\n      // If groupId is undefined, we fallback to wrappingGroupId.\n      // If groupId === null, we want selectdGroupId to be null as well.\n      // Otherwise (groupId is of type string), we use groupId.\n      //\n      const selectedGroupId = groupId === undefined ? wrappingGroupId : groupId;\n\n      const triggerEl = selectedGroupId\n        ? tooltipGroups[selectedGroupId]\n        : element;\n\n      tooltipMethods.setPopperTooltipTriggerRef?.(triggerEl);\n      tooltipMethods.setAppTooltipProps?.({ title, ...appTooltipProps });\n      tooltipMethods.popperTooltipUpdate?.();\n\n      deferredShowTooltip(globalTooltipProps.delay, () =>\n        tooltipMethods.setAppTooltipVisible?.(true)\n      );\n    }\n\n    function onMouseLeave(e: MouseEvent) {\n      deferredHideTooltip(() => tooltipMethods.setAppTooltipVisible?.(false));\n    }\n\n    element?.addEventListener('mouseenter', onMouseEnter);\n    element?.addEventListener('mouseleave', onMouseLeave);\n  };\n}\n"],"names":["singletons","useSingleton","name","useEffect","Error","DEFAULT_DELAY","tooltipMethods","globalTooltipProps","delay","resetTooltipMethods","Object","keys","forEach","key","initTooltipMethods","methods","assign","setGlobalTooltipProps","props","createCssVarsForStyleProp","cssVars","cx","args","filter","Boolean","join","Tooltip","backgroundColor","borderColor","arrowSize","className","arrowClassName","useState","tooltipVisible","setTooltipVisible","childRect","popoverRect","parentRect","boundaryRect","padding","nudgedLeft","nudgedTop","boundaryInset","popoverState","setPopoverState","childRef","useRef","usePopover","positions","align","reposition","parentElement","document","body","boundaryElement","onPositionPopover","positionPopover","popoverRef","useArrowContainer","arrowColor","arrowContainerStyle","arrowStyle","setPopperTooltipTriggerRef","ref","current","undefined","setAppTooltipProps","contentRef","titleRef","subtitleRef","style","maxWidth","innerText","title","display","subtitle","setAppTooltipVisible","popperTooltipUpdate","ReactDOM","createPortal","React","styles","tooltipContainer","visibility","createElement","arrow","content","tooltipGroups","tooltipGroup","groupId","element","Math","round","random","toString","handleMouseOver","e","currentTarget","addEventListener","capture","dataset","okTooltipGroupId","state","timeout","wait","callback","window","setTimeout","unwait","clearTimeout","deferredShowTooltip","showTooltip","deferredHideTooltip","hideTooltip","tooltip","appTooltipProps","onMouseEnter","wrappingGroupId","closest","selectedGroupId","triggerEl","onMouseLeave"],"mappings":"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"}